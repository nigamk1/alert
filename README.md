# Nifty Alert System - EMA Breakdown Strategy

A self-hosted alert system that monitors Nifty 50 options for bearish entry signals based on EMA breakdown patterns and sends alerts via WhatsApp.

## ðŸŽ¯ Strategy Overview

This system implements a bearish options strategy with the following conditions:

### Entry Conditions
1. **Signal Candle**: Entire candle (OHLC) is above 5-period EMA with minimum body size
2. **Price Break**: Next candle breaks below the signal candle's low
3. **Bearish Candle**: Next candle is bearish (close < open)
4. **High Volume**: Volume is higher than 20-period SMA
5. **Downtrend**: Price is below 200-period EMA

When all conditions are met, a WhatsApp alert is sent immediately.

## ðŸ“ Project Structure

```
alert-system/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ dataFetcher.js     # NSE data fetching
â”‚   â”œâ”€â”€ strategy.js        # EMA breakdown logic
â”‚   â”œâ”€â”€ alertSender.js     # WhatsApp integration
â”‚   â”œâ”€â”€ scheduler.js       # Task scheduling
â”‚   â””â”€â”€ utils.js           # Helper functions
â”œâ”€â”€ logs/
â”‚   â””â”€â”€ signals.log        # Alert logs
â”œâ”€â”€ .env                   # Configuration
â”œâ”€â”€ index.js              # Main entry point
â”œâ”€â”€ package.json          # Dependencies
â””â”€â”€ README.md             # This file
```

## ðŸš€ Setup Instructions

### 1. Install Dependencies

```bash
npm install
```

### 2. Configure Environment

Edit `.env` file with your settings:

```env
WHATSAPP_TARGET=9083721051@c.us
RUN_INTERVAL_MINUTES=1
ALERT_STRATEGY=EMA_BREAKDOWN
NSE_URL=https://www.nseindia.com/api/option-chain-indices?symbol=NIFTY
MIN_BODY_SIZE_PERCENT=0.1
EMA_FAST_PERIOD=5
EMA_SLOW_PERIOD=200
VOLUME_SMA_PERIOD=20
OPTION_TYPE=PUT
LOG_FILE=./logs/signals.log
```

### 3. First Run (WhatsApp Authentication)

```bash
npm start
```

When you first run the system, it will display a QR code in the terminal. Scan this QR code with your WhatsApp to authenticate the bot.

### 4. Running the System

After authentication, the system will:
- Monitor Nifty 50 options data every minute
- Calculate EMA and volume indicators
- Check for bearish entry signals
- Send WhatsApp alerts when conditions are met
- Log all activities

## ðŸ“± WhatsApp Integration

### Setup Process
1. Run the system for the first time
2. Scan the QR code with your WhatsApp
3. The system will authenticate and connect
4. You'll receive a startup notification

### Message Format
```
ðŸ”» BEARISH ENTRY TRIGGERED

ðŸ“Š Option: Nifty 22100 PUT
ðŸ’° Entry Price: â‚¹48.50
â° Time: 14:30:15
ðŸ“‰ Signal Candle Low: â‚¹45.20

ðŸ“ˆ Technical Analysis:
â€¢ Break below signal low âœ…
â€¢ Bearish candle âœ…
â€¢ High volume âœ…
â€¢ Below EMA200 âœ…

ðŸ“Š Market Data:
â€¢ Volume: 25,000
â€¢ Volume SMA: 18,500
â€¢ EMA5: â‚¹47.80
â€¢ EMA200: â‚¹52.10

ðŸŽ¯ Strategy: EMA Breakdown
âš¡ Generated by: Auto Alert System
```

## ðŸ”§ Running Options

### Normal Mode
```bash
npm start
```

### Test Mode
```bash
npm start -- --test
```

### Status Check
```bash
npm start -- --status
```

### Development Mode
```bash
npm run dev
```

## ðŸ“Š Features

### Data Fetching
- Real-time NSE options data
- Automatic ATM strike detection
- Rate limiting and error handling
- Fallback to cached data

### Strategy Engine
- EMA(5) and EMA(200) calculations
- Volume SMA(20) analysis
- Signal candle identification
- Entry condition validation
- Alert cooldown management

### WhatsApp Integration
- QR code authentication
- Automatic message sending
- Rich formatted messages
- Status updates
- Error notifications

### Scheduler
- Configurable intervals
- Market hours detection
- Error handling and recovery
- Status reporting
- Graceful shutdown

### Logging
- Detailed activity logs
- Error tracking
- Alert history
- Performance metrics

## ðŸ› ï¸ Configuration Options

### Environment Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `WHATSAPP_TARGET` | Target phone number | Required |
| `RUN_INTERVAL_MINUTES` | Check interval | 1 |
| `EMA_FAST_PERIOD` | Fast EMA period | 5 |
| `EMA_SLOW_PERIOD` | Slow EMA period | 200 |
| `VOLUME_SMA_PERIOD` | Volume SMA period | 20 |
| `MIN_BODY_SIZE_PERCENT` | Minimum candle body size | 0.1 |

### Market Hours
- Trading hours: 9:15 AM to 3:30 PM IST
- Weekdays only
- Automatic detection

## ðŸ“ Logs

All activities are logged to `logs/signals.log`:

```
[2025-07-18 14:30:15] INFO: Alert system started
[2025-07-18 14:31:00] DATA: ATM PUT 22100 - Price: â‚¹48.50, Volume: 25000
[2025-07-18 14:31:05] SIGNAL CANDLE: Entire candle above EMA5 (47.80), Body size: 1.2%
[2025-07-18 14:32:00] ALERT: Bearish entry signal detected
[2025-07-18 14:32:05] INFO: Alert sent successfully via WhatsApp
```

## ðŸ”’ Security & Privacy

- All data processing happens locally
- No external API keys required (except NSE public data)
- WhatsApp authentication is local
- No data is shared with third parties

## ðŸ› Troubleshooting

### Common Issues

1. **WhatsApp QR Code Not Appearing**
   - Check internet connection
   - Try restarting the system
   - Clear any existing authentication data

2. **Data Fetching Errors**
   - NSE API may be temporarily unavailable
   - Check internet connection
   - System will retry automatically

3. **No Alerts Received**
   - Ensure market is open
   - Check if conditions are actually met
   - Verify WhatsApp is connected
   - Check alert cooldown period

4. **High CPU Usage**
   - Increase interval between checks
   - Reduce historical data retention

### Debug Commands

```bash
# Check system status
npm start -- --status

# Run test cycle
npm start -- --test

# View logs
tail -f logs/signals.log
```

## ðŸ“ˆ Performance

- Memory usage: ~50-100MB
- CPU usage: <5% during normal operation
- Network: Minimal (only NSE API calls)
- Storage: Logs rotate automatically

## ðŸ”„ Updates & Maintenance

### Regular Tasks
- Monitor log files
- Check alert accuracy
- Update dependencies
- Review strategy performance

### Backup
- `.env` configuration
- WhatsApp authentication data
- Historical logs

## ðŸ“ž Support

For issues or questions:
1. Check the logs first
2. Try running in test mode
3. Review the troubleshooting section
4. Check NSE API status

## ðŸŽ¯ Future Enhancements

- Multiple strategy support
- Web dashboard
- Email alerts
- Telegram integration
- Advanced backtesting
- Portfolio management

## âš ï¸ Disclaimer

This system is for educational and personal use only. Trading involves risk, and you should always do your own research before making investment decisions. The authors are not responsible for any financial losses.

## ðŸ“„ License

MIT License - See LICENSE file for details.
